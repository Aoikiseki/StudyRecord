### 加下方二维码

```swift
func generateQRSnapshot() -> UIImage? {
    guard let snapshot = generateSnapshot(),
    ImageUtils.isImageValid(snapshot) else { return nil }
    let qrCodeViewSize = CGSize(width: snapshot.size.width, height: 82.0)
    let qrCodeCell = ShareLogoCell(frame: .init(origin: .zero, size: qrCodeViewSize))
    qrCodeCell.bindData(with: .init(qrCodeImage: UIImage(named: "finish_share_QR")))
    let qrCodeViewImage = qrCodeCell.leo.snapshot()

    UIGraphicsBeginImageContextWithOptions(.init(width: snapshot.size.width, height: snapshot.size.height + qrCodeViewSize.height), false, UIScreen.main.scale)
    defer { UIGraphicsEndImageContext() }
    snapshot.draw(in: .init(origin: .zero, size: snapshot.size))
    qrCodeViewImage?.draw(in: .init(origin: .init(x: 0, y: snapshot.size.height), size: qrCodeViewSize))
    return UIGraphicsGetImageFromCurrentImageContext()
}
```




anchorPoint、position、frame

https://www.cnblogs.com/Free-Thinker/p/11269662.html



### presentingViewController、presentedViewController

A present B **modally**：

- 则B.presentingViewController == A，如果B没有被A present modally，但是B的某个祖先被present modally，则该属性被赋为展示该祖先的VC，否则为nil
- 则A.presentedViewController == B

项目中的例子：popOrDismiss

```swift
(BOOL)isPresentedViewController:(UIViewController *)viewController {
    // 1. VC1(presenting) -> VC2(presented, end) => VC2 is presented
    BOOL isPresented = viewController.presentingViewController.presentedViewController == viewController;

    // 2. VC1(presenting) -> VC2(presented, UINavigationController) ~> VC3(pushed, end)  => VC2 and VC3 is presented
    if (viewController.navigationController != nil &&
        (viewController == viewController.navigationController.viewControllers[0] ||
         viewController.parentViewController == viewController.navigationController.viewControllers[0])) {
        isPresented |= viewController.presentingViewController.presentedViewController == viewController.navigationController;
    }

    // NOTE: 场景3和4暂无需求，不判断了
    // 3. VC1(presenting) -> VC2(presented, UITabBarController) ~> VC3(UINavigationController) ~> VC4(pushed, end)  => VC2, VC3 and VC4 is presented
    // 4. VC1(presenting) -> VC2(presented, UITabBarController) ~> VC3(end) => VC2 and VC3 is presented
    return isPresented;
}
```



### 计算日期和时间间隔

```swift
let dateNow = Date()
let dateDiff = date.timeIntervalSince1970 - dateNow.timeIntervalSince1970
if dateDiff < 0 {
    countDownBag = DisposeBag()
    countDownLabel.isHidden = true
    return
}

let difference = Calendar.current.dateComponents([.hour, .minute, .second], from: dateNow, to: date)
if 	let hour = difference.hour,
		let minute = difference.minute,
		let second = difference.second
{
    let realHour = hour % 24
    let formattedString = String(format: "%02ld:%02ld:%02ld", hour, minute, second)
    countDownLabel.text = formattedString
}
```



## protoBuf

```swift
protoc --swift_opt=Visibility=Public --swift_out=. *.proto
```

## 文本编辑UITextView

- 退出编辑状态

```swift
self.endEditing(true)
```







